# CVE-2017-15302 : CPUID CPU-Z Kernel Driver arbitrary read Privilege Escalation Vulnerability

# Suggested description
> In CPUID CPU-Z through 1.81, there are
> improper access rights to a kernel-mode driver
> (e.g., cpuz143_x64.sys for version 1.43) that can result in information disclosure or
> elevation of privileges, because of an arbitrary read of any physical address (ioctl: 0x9C402604). Any application running on the system
> (Windows), including sandboxed users, can issue an ioctl to this
> driver without any validation. Furthermore, the driver
> can map any physical page on the system and returns the allocated map
> page address to the user: that results in an information leak and
> EoP. NOTE: the vendor indicates that the arbitrary read itself is intentional behavior
> (for ACPI scan functionality); the security issue is the lack of an ACL.
>
> ------------------------------------------
>
# Additional Information
> the vendor will correct the above with editing the ACL on the driver.
>
> ------------------------------------------
>
# Vulnerability Type
> Incorrect Access Control
>
> ------------------------------------------
>
# Vendor of Product
> https://www.cpuid.com/softwares/cpu-z.html
>
> ------------------------------------------
>
# Affected Product Code Base
> cpuz143_x64.sys - 143
>
> ------------------------------------------
>
# Affected Component
cpuz143_x64.sys<br>
SHA256          EE45FD2D7315FD039F3585A66E7855BA4AF9D4721E1448E602623DE14E932BBE<br>
> ------------------------------------------
>
# Attack Type
> Local
>
> ------------------------------------------
>
# Impact Escalation of Privileges
> true
>
> ------------------------------------------
>
# Impact Information Disclosure
> true
>
> ------------------------------------------
>
# Attack Vectors
> specially crafted application
>
> ------------------------------------------
>
# Has vendor confirmed or acknowledged the vulnerability?
> true
>
> ------------------------------------------
>
at the time of writing the vendor did not issue a patch to address this vulnerability, the end users are advised to menually change the access permissions to the kernel mode driver once its loaded (cpuz143).

# edit:
this is now fixed in VERSION 1.83 FOR WINDOWS update your software.

# External links:
<html><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15302">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15302</a></html>.<br>
<html><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-15302">https://nvd.nist.gov/vuln/detail/CVE-2017-15302</a></html>.<br>
